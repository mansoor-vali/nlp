import nltk
from nltk.corpus import treebank
from nltk.tag import hmm

# Make sure to install NLTK and download required corpora:
# Run these in terminal or Jupyter before running the script:
# pip install -U nltk
# python -m nltk.downloader treebank averaged_perceptron_tagger maxent_ne_chunker words

# Download required NLTK data (if you want to keep in script):
nltk.download('treebank')
nltk.download('averaged_perceptron_tagger')
nltk.download('maxent_ne_chunker')
nltk.download('words')

# Load corpus
corpus = list(treebank.tagged_sents())

# Split data 80/20 train-test
train_data = corpus[:int(0.8 * len(corpus))]
test_data = corpus[int(0.8 * len(corpus)):]

# Train HMM tagger
hmm_trainer = hmm.HiddenMarkovModelTrainer()
hmm_tagger = hmm_trainer.train(train_data)

# Evaluate
hmm_accuracy = hmm_tagger.evaluate(test_data)
print(f"HMM Tagger Accuracy: {hmm_accuracy:.4f}")
